import{useState as e,useRef as r,useEffect as t,cloneElement as o}from"react";import{jsxs as n,jsx as s}from"react/jsx-runtime";import a from"axios";!function(e,r){void 0===r&&(r={});var t=r.insertAt;if(e&&"undefined"!=typeof document){var o=document.head||document.getElementsByTagName("head")[0],n=document.createElement("style");n.type="text/css","top"===t&&o.firstChild?o.insertBefore(n,o.firstChild):o.appendChild(n),n.styleSheet?n.styleSheet.cssText=e:n.appendChild(document.createTextNode(e))}}('.grammar-checker{font-family:Segoe UI,Tahoma,Geneva,Verdana,sans-serif;margin:20px auto;max-width:800px;padding:20px}.header{align-items:center;display:flex;justify-content:space-between;margin-bottom:20px}.header h2{color:#333;margin:0}.loading-indicator{color:#2196f3;font-size:14px;font-weight:500}.input-container{margin-bottom:20px;position:relative}.text-input,.textarea-wrapper{position:relative;width:100%}.text-input{background:#fff;border:2px solid #ddd;border-radius:8px;box-sizing:border-box;color:#333;font-family:inherit;font-size:16px;line-height:1.5;min-height:200px;padding:12px;resize:vertical;z-index:1}.text-input:focus{border-color:#2196f3;outline:none}.highlight-overlay{word-wrap:break-word;border:2px solid #0000;border-radius:8px;bottom:0;box-sizing:border-box;color:#0000;font-family:inherit;font-size:16px;left:0;line-height:1.5;margin:0;overflow:hidden;padding:12px;pointer-events:none;position:absolute;right:0;top:0;white-space:pre-wrap;z-index:2}.grammar-error{background:#0000;border-radius:2px;color:#333;cursor:pointer;pointer-events:auto;position:relative;text-decoration:underline;text-decoration-color:red;text-decoration-style:wavy;text-underline-offset:2px;transition:background-color .2s ease}.grammar-error:hover{background-color:#ff00001a}.suggestion-tooltip{background:#333;border-radius:8px;box-shadow:0 4px 12px #0000004d;color:#fff;font-size:14px;max-width:280px;padding:12px;pointer-events:auto;position:fixed;z-index:1000}.suggestion-tooltip:before{border:6px solid;border-color:#0000 #0000 #333;content:"";left:20px;position:absolute;top:-6px}.tooltip-message{color:#e0e0e0;font-size:13px;margin-bottom:10px}.suggestions{margin-top:8px}.suggestions strong{color:#fff;display:block;margin-bottom:6px}.suggestion-btn{background:#2196f3;border:none;border-radius:4px;color:#fff;cursor:pointer;font-size:12px;margin:2px 6px 2px 0;padding:6px 10px;transition:background-color .2s ease}.suggestion-btn:hover{background:#1976d2;transform:translateY(-1px)}.suggestion-btn:active{transform:translateY(0)}.error-summary{background-color:#fff3cd;border:1px solid #ffeaa7;border-radius:6px;color:#856404;margin-bottom:10px}.error-summary,.no-errors{font-weight:500;padding:12px}.no-errors{background-color:#d4edda;border:1px solid #c3e6cb;border-radius:6px;color:#155724}');const i=a=>{let{children:i}=a;const[l,c]=e(""),[d,g]=e([]),[p,u]=e(!1),[f,m]=e(null),[h,x]=e({x:0,y:0}),b=r(null),y=r(null);t(()=>{if(l.length>0){u(!0);const e=setTimeout(async()=>{try{const e=await(async e=>{try{const r=await fetch("http://127.0.0.1:5555/api/check",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({text:e})});if(!r.ok)throw new Error("HTTP error ".concat(r.status));return{errors:((await r.json()).errors||[]).map(e=>({bad:e.bad,message:e.message,suggestions:e.suggestions||[],offset:e.offset,length:e.length}))}}catch(e){return console.error("API request failed:",e),{errors:[]}}})(l);g(e.errors||[])}catch(e){console.error("Grammar check failed:",e),g([])}finally{u(!1)}},600);return()=>clearTimeout(e)}g([])},[l]);const v=o(i,{ref:b,value:l,onChange:e=>c(e.target.value),onScroll:()=>{b.current&&y.current&&(y.current.scrollTop=b.current.scrollTop,y.current.scrollLeft=b.current.scrollLeft)},className:(i.props.className||"")+" text-input"});return n("div",{className:"grammar-rectifier",children:[s("div",{className:"header",children:p&&s("div",{className:"loading-indicator",children:"Checking..."})}),n("div",{className:"input-container",children:[n("div",{className:"textarea-wrapper",children:[v,s("div",{ref:y,className:"highlight-overlay",dangerouslySetInnerHTML:{__html:(()=>{if(0===d.length)return l;let e=l;return[...d].sort((e,r)=>r.offset-e.offset).forEach(r=>{const t=e.substring(0,r.offset),o=e.substring(r.offset,r.offset+r.length),n=e.substring(r.offset+r.length);e=t+'<span class="grammar-error" data-error="'.concat(r.bad,'" data-suggestions="').concat(r.suggestions.join(","),'" data-message="').concat(r.message,'">').concat(o,"</span>")+n}),e})()},onMouseMove:e=>{if(e.target.classList.contains("grammar-error")){const r=e.target.getAttribute("data-error"),t=e.target.getAttribute("data-suggestions").split(",").filter(e=>e),o=e.target.getAttribute("data-message");m({word:r,suggestions:t,message:o});const n=e.target.getBoundingClientRect();x({x:n.left+window.scrollX,y:n.bottom+window.scrollY+5})}else m(null)},onMouseLeave:()=>m(null)})]}),f&&n("div",{className:"suggestion-tooltip",style:{left:h.x,top:h.y},children:[s("div",{className:"tooltip-message",children:f.message}),f.suggestions.length>0&&n("div",{className:"suggestions",children:[s("strong",{children:"Suggestions:"}),f.suggestions.map((e,r)=>s("button",{className:"suggestion-btn",onClick:()=>(e=>{if(f){const r=d.find(e=>e.bad===f.word);if(r){const t=r.offset,o=r.offset+r.length,n=l.substring(0,t)+e+l.substring(o);c(n)}else{const r=l.indexOf(f.word);if(-1!==r){const t=l.substring(0,r)+e+l.substring(r+f.word.length);c(t)}}m(null)}})(e),children:e},r))]})]})]}),d.length>0&&n("div",{className:"error-summary",children:["Found ",d.length," error",d.length>1?"s":""]}),l&&0===d.length&&!p&&s("div",{className:"no-errors",children:"No grammar errors!"})]})},l=async e=>{try{return(await a.post("http://127.0.0.1:5555/api/check",{text:e})).data}catch(e){throw console.error("Error checking grammar:",e),e}};export{i as GrammarRectifier,l as checkGrammar};
//# sourceMappingURL=index.esm.js.map
