"use strict";Object.defineProperty(exports,"__esModule",{value:!0});var e=require("react"),t=require("react/jsx-runtime");function r(e){return e&&"object"==typeof e&&"default"in e?e:{default:e}}var o=r(require("axios"));!function(e,t){void 0===t&&(t={});var r=t.insertAt;if(e&&"undefined"!=typeof document){var o=document.head||document.getElementsByTagName("head")[0],s=document.createElement("style");s.type="text/css","top"===r&&o.firstChild?o.insertBefore(s,o.firstChild):o.appendChild(s),s.styleSheet?s.styleSheet.cssText=e:s.appendChild(document.createTextNode(e))}}('.grammar-checker{font-family:Segoe UI,Tahoma,Geneva,Verdana,sans-serif;margin:20px auto;max-width:800px;padding:20px}.header{align-items:center;display:flex;justify-content:space-between;margin-bottom:20px}.header h2{color:#333;margin:0}.loading-indicator{color:#2196f3;font-size:14px;font-weight:500}.input-container{margin-bottom:20px;position:relative}.text-input,.textarea-wrapper{position:relative;width:100%}.text-input{background:#fff;border:2px solid #ddd;border-radius:8px;box-sizing:border-box;color:#333;font-family:inherit;font-size:16px;line-height:1.5;min-height:200px;padding:12px;resize:vertical;z-index:1}.text-input:focus{border-color:#2196f3;outline:none}.highlight-overlay{word-wrap:break-word;border:2px solid #0000;border-radius:8px;bottom:0;box-sizing:border-box;color:#0000;font-family:inherit;font-size:16px;left:0;line-height:1.5;margin:0;overflow:hidden;padding:12px;pointer-events:none;position:absolute;right:0;top:0;white-space:pre-wrap;z-index:2}.grammar-error{background:#0000;border-radius:2px;color:#333;cursor:pointer;pointer-events:auto;position:relative;text-decoration:underline;text-decoration-color:red;text-decoration-style:wavy;text-underline-offset:2px;transition:background-color .2s ease}.grammar-error:hover{background-color:#ff00001a}.suggestion-tooltip{background:#333;border-radius:8px;box-shadow:0 4px 12px #0000004d;color:#fff;font-size:14px;max-width:280px;padding:12px;pointer-events:auto;position:fixed;z-index:1000}.suggestion-tooltip:before{border:6px solid;border-color:#0000 #0000 #333;content:"";left:20px;position:absolute;top:-6px}.tooltip-message{color:#e0e0e0;font-size:13px;margin-bottom:10px}.suggestions{margin-top:8px}.suggestions strong{color:#fff;display:block;margin-bottom:6px}.suggestion-btn{background:#2196f3;border:none;border-radius:4px;color:#fff;cursor:pointer;font-size:12px;margin:2px 6px 2px 0;padding:6px 10px;transition:background-color .2s ease}.suggestion-btn:hover{background:#1976d2;transform:translateY(-1px)}.suggestion-btn:active{transform:translateY(0)}.error-summary{background-color:#fff3cd;border:1px solid #ffeaa7;border-radius:6px;color:#856404;margin-bottom:10px}.error-summary,.no-errors{font-weight:500;padding:12px}.no-errors{background-color:#d4edda;border:1px solid #c3e6cb;border-radius:6px;color:#155724}');exports.GrammarRectifier=r=>{let{children:o}=r;const[s,n]=e.useState(""),[a,i]=e.useState([]),[l,c]=e.useState(!1),[d,g]=e.useState(null),[u,p]=e.useState({x:0,y:0}),f=e.useRef(null),m=e.useRef(null);e.useEffect(()=>{if(s.length>0){c(!0);const e=setTimeout(async()=>{try{const e=await(async e=>{try{const t=await fetch("http://127.0.0.1:5555/api/check",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({text:e})});if(!t.ok)throw new Error("HTTP error ".concat(t.status));return{errors:((await t.json()).errors||[]).map(e=>({bad:e.bad,message:e.message,suggestions:e.suggestions||[],offset:e.offset,length:e.length}))}}catch(e){return console.error("API request failed:",e),{errors:[]}}})(s);i(e.errors||[])}catch(e){console.error("Grammar check failed:",e),i([])}finally{c(!1)}},600);return()=>clearTimeout(e)}i([])},[s]);const x=e.cloneElement(o,{ref:f,value:s,onChange:e=>n(e.target.value),onScroll:()=>{f.current&&m.current&&(m.current.scrollTop=f.current.scrollTop,m.current.scrollLeft=f.current.scrollLeft)},className:(o.props.className||"")+" text-input"});return t.jsxs("div",{className:"grammar-rectifier",children:[t.jsx("div",{className:"header",children:l&&t.jsx("div",{className:"loading-indicator",children:"Checking..."})}),t.jsxs("div",{className:"input-container",children:[t.jsxs("div",{className:"textarea-wrapper",children:[x,t.jsx("div",{ref:m,className:"highlight-overlay",dangerouslySetInnerHTML:{__html:(()=>{if(0===a.length)return s;let e=s;return[...a].sort((e,t)=>t.offset-e.offset).forEach(t=>{const r=e.substring(0,t.offset),o=e.substring(t.offset,t.offset+t.length),s=e.substring(t.offset+t.length);e=r+'<span class="grammar-error" data-error="'.concat(t.bad,'" data-suggestions="').concat(t.suggestions.join(","),'" data-message="').concat(t.message,'">').concat(o,"</span>")+s}),e})()},onMouseMove:e=>{if(e.target.classList.contains("grammar-error")){const t=e.target.getAttribute("data-error"),r=e.target.getAttribute("data-suggestions").split(",").filter(e=>e),o=e.target.getAttribute("data-message");g({word:t,suggestions:r,message:o});const s=e.target.getBoundingClientRect();p({x:s.left+window.scrollX,y:s.bottom+window.scrollY+5})}else g(null)},onMouseLeave:()=>g(null)})]}),d&&t.jsxs("div",{className:"suggestion-tooltip",style:{left:u.x,top:u.y},children:[t.jsx("div",{className:"tooltip-message",children:d.message}),d.suggestions.length>0&&t.jsxs("div",{className:"suggestions",children:[t.jsx("strong",{children:"Suggestions:"}),d.suggestions.map((e,r)=>t.jsx("button",{className:"suggestion-btn",onClick:()=>(e=>{if(d){const t=a.find(e=>e.bad===d.word);if(t){const r=t.offset,o=t.offset+t.length,a=s.substring(0,r)+e+s.substring(o);n(a)}else{const t=s.indexOf(d.word);if(-1!==t){const r=s.substring(0,t)+e+s.substring(t+d.word.length);n(r)}}g(null)}})(e),children:e},r))]})]})]}),a.length>0&&t.jsxs("div",{className:"error-summary",children:["Found ",a.length," error",a.length>1?"s":""]}),s&&0===a.length&&!l&&t.jsx("div",{className:"no-errors",children:"No grammar errors!"})]})},exports.checkGrammar=async e=>{try{return(await o.default.post("http://127.0.0.1:5555/api/check",{text:e})).data}catch(e){throw console.error("Error checking grammar:",e),e}};
//# sourceMappingURL=index.js.map
