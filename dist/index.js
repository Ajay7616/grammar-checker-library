"use strict";Object.defineProperty(exports,"__esModule",{value:!0});var t=require("react"),r=require("react/jsx-runtime");!function(t,r){void 0===r&&(r={});var o=r.insertAt;if(t&&"undefined"!=typeof document){var e=document.head||document.getElementsByTagName("head")[0],n=document.createElement("style");n.type="text/css","top"===o&&e.firstChild?e.insertBefore(n,e.firstChild):e.appendChild(n),n.styleSheet?n.styleSheet.cssText=t:n.appendChild(document.createTextNode(t))}}('.grammar-checker{font-family:Segoe UI,Tahoma,Geneva,Verdana,sans-serif!important;margin:20px auto!important;max-width:800px!important;padding:20px!important}.header{align-items:center!important;display:flex!important;justify-content:space-between!important;margin-bottom:20px!important}.header h2{color:#333!important;margin:0!important}.loading-indicator{color:#2196f3!important;font-size:14px!important;font-weight:500!important}.input-container{margin-bottom:20px!important;position:relative!important}.text-input,.textarea-wrapper{position:relative!important;width:100%!important}.text-input{background:#fff!important;border:2px solid #ddd!important;border-radius:8px!important;box-sizing:border-box!important;color:#333!important;font-family:inherit!important;font-size:16px!important;line-height:1.5!important;min-height:200px!important;padding:12px!important;resize:vertical!important;z-index:1!important}.text-input:focus{border-color:#2196f3!important;outline:none!important}.highlight-overlay{word-wrap:break-word!important;border:2px solid #0000!important;border-radius:8px!important;bottom:0!important;box-sizing:border-box!important;color:#0000!important;font-family:inherit!important;font-size:16px!important;left:0!important;line-height:1.5!important;margin:0!important;overflow:hidden!important;padding:12px!important;pointer-events:none!important;position:absolute!important;right:0!important;top:0!important;white-space:pre-wrap!important;z-index:2!important}.grammar-error{background:#0000!important;border-radius:2px!important;color:#333!important;cursor:pointer!important;display:inline!important;pointer-events:auto!important;position:static!important;text-decoration:underline!important;text-decoration-color:red!important;text-decoration-style:wavy!important;text-underline-offset:2px!important;transition:background-color .2s ease!important;vertical-align:initial!important;white-space:pre-wrap!important}.grammar-error:hover{background-color:#ff00001a!important}.suggestion-tooltip{background:#333!important;border-radius:8px!important;box-shadow:0 4px 12px #0000004d!important;color:#fff!important;font-size:14px!important;max-width:280px!important;padding:12px!important;pointer-events:auto!important;position:fixed!important;z-index:1000!important}.suggestion-tooltip:before{border:6px solid!important;border-color:#0000 #0000 #333!important;content:""!important;left:20px!important;position:absolute!important;top:-6px!important}.tooltip-message{color:#e0e0e0!important;font-size:13px!important;margin-bottom:10px!important}.suggestions{margin-top:8px!important}.suggestions strong{color:#fff!important;display:block!important;margin-bottom:6px!important}.suggestion-btn{background:#2196f3!important;border:none!important;border-radius:4px!important;color:#fff!important;cursor:pointer!important;font-size:12px!important;margin:2px 6px 2px 0!important;padding:6px 10px!important;transition:background-color .2s ease!important}.suggestion-btn:hover{background:#1976d2!important;transform:translateY(-1px)!important}.suggestion-btn:active{transform:translateY(0)!important}.error-summary{background-color:#fff3cd!important;border:1px solid #ffeaa7!important;border-radius:6px!important;color:#856404!important;margin-bottom:10px!important}.error-summary,.no-errors{font-weight:500!important;padding:12px!important}.no-errors{background-color:#d4edda!important;border:1px solid #c3e6cb!important;border-radius:6px!important;color:#155724!important}');exports.GrammarRectifier=o=>{let{children:e}=o;const[n,a]=t.useState(""),[i,s]=t.useState([]),[p,m]=t.useState(!1),[c,l]=t.useState(null),[d,g]=t.useState({x:0,y:0}),u=t.useRef(null),f=t.useRef(null);t.useEffect(()=>{if(n.length>0){m(!0);const t=setTimeout(async()=>{try{const t=await(async t=>{try{const r=await fetch("http://127.0.0.1:5555/api/check",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({text:t})});if(!r.ok)throw new Error("HTTP error ".concat(r.status));return{errors:((await r.json()).errors||[]).map(t=>({bad:t.bad,message:t.message,suggestions:t.suggestions||[],offset:t.offset,length:t.length}))}}catch(t){return console.error("API request failed:",t),{errors:[]}}})(n);s(t.errors||[])}catch(t){console.error("Grammar check failed:",t),s([])}finally{m(!1)}},600);return()=>clearTimeout(t)}s([])},[n]);const x=t.cloneElement(e,{ref:u,value:n,onChange:t=>a(t.target.value),onScroll:()=>{u.current&&f.current&&(f.current.scrollTop=u.current.scrollTop,f.current.scrollLeft=u.current.scrollLeft)},className:(e.props.className||"")+" text-input"});return r.jsxs("div",{className:"grammar-rectifier",children:[r.jsx("div",{className:"header",children:p&&r.jsx("div",{className:"loading-indicator",children:"Checking..."})}),r.jsxs("div",{className:"input-container",children:[r.jsxs("div",{className:"textarea-wrapper",children:[x,r.jsx("div",{ref:f,className:"highlight-overlay",dangerouslySetInnerHTML:{__html:(()=>{if(0===i.length)return n;let t=n;return[...i].sort((t,r)=>r.offset-t.offset).forEach(r=>{const o=t.substring(0,r.offset),e=t.substring(r.offset,r.offset+r.length),n=t.substring(r.offset+r.length);t=o+'<span class="grammar-error" data-error="'.concat(r.bad,'" data-suggestions="').concat(r.suggestions.join(","),'" data-message="').concat(r.message,'">').concat(e,"</span>")+n}),t})()},onMouseMove:t=>{if(t.target.classList.contains("grammar-error")){const r=t.target.getAttribute("data-error"),o=t.target.getAttribute("data-suggestions").split(",").filter(t=>t),e=t.target.getAttribute("data-message");l({word:r,suggestions:o,message:e});const n=t.target.getBoundingClientRect();g({x:n.left+window.scrollX,y:n.bottom+window.scrollY+5})}else l(null)},onMouseLeave:()=>l(null)})]}),c&&r.jsxs("div",{className:"suggestion-tooltip",style:{left:d.x,top:d.y},children:[r.jsx("div",{className:"tooltip-message",children:c.message}),c.suggestions.length>0&&r.jsxs("div",{className:"suggestions",children:[r.jsx("strong",{children:"Suggestions:"}),c.suggestions.map((t,o)=>r.jsx("button",{className:"suggestion-btn",onClick:()=>(t=>{if(c){const r=i.find(t=>t.bad===c.word);if(r){const o=r.offset,e=r.offset+r.length,i=n.substring(0,o)+t+n.substring(e);a(i)}else{const r=n.indexOf(c.word);if(-1!==r){const o=n.substring(0,r)+t+n.substring(r+c.word.length);a(o)}}l(null)}})(t),children:t},o))]})]})]}),i.length>0&&r.jsxs("div",{className:"error-summary",children:["Found ",i.length," error",i.length>1?"s":""]}),n&&0===i.length&&!p&&r.jsx("div",{className:"no-errors",children:"No grammar errors!"})]})},exports.checkGrammar=async t=>{try{const r=await fetch("http://127.0.0.1:5555/api/check",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({text:t})});if(!r.ok)throw new Error("HTTP error! Status: ".concat(r.status));return await r.json()}catch(t){throw console.error("Error checking grammar:",t),t}};
//# sourceMappingURL=index.js.map
